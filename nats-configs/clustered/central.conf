# NATS Server Configuration for Central Cluster - Node 1
server_name: $NATS_SERVER_NAME
# server_tags: [$NATS_SERVER_TAG]

# Client connection
port: 4222

# HTTP monitoring port
http_port: 8222

accounts {
  $SYS {
    users [
      {
        user: $NATS_SYSTEM_USER
        password: $NATS_SYSTEM_PASSWORD
      }
    ]
  }

  # APP {
  #   jetstream: enabled
  #   users [
  #     {
  #       user: app
  #       password: app
  #     }
  #   ]

  #   mappings {
  #     "game_action.*": "mapped_game_action.{{wildcard(1)}}.{{partition(3,1)}}"
  #     "foo": "bar"
  #   }
  # }
}

mappings {
  "game_action.*": "mapped_game_action.{{wildcard(1)}}.{{partition(3,1)}}"
  "foo": "bar"
}

# Clustering configuration
cluster {
  name: "central"
  port: 6222
  routes: [
    "nats-route://nats-central-1:6222",
    "nats-route://nats-central-2:6222",
    "nats-route://nats-central-3:6222"
  ]
}

# Gateway configuration for super cluster
gateway {
  name: "central"
  port: 7222
  gateways: [
    {
      name: "east"
      urls: ["nats://nats-east-1:7222", "nats://nats-east-2:7222", "nats://nats-east-3:7222"]
    },
    {
      name: "west"
      urls: ["nats://nats-west-1:7222", "nats://nats-west-2:7222", "nats://nats-west-3:7222"]
    }
  ]
}

# JetStream configuration
jetstream {
    store_dir: "/data/jetstream"
    max_memory_store: 256MB
    max_file_store: 2GB
}

# Logging
debug: false
trace: false
logtime: true

# Limits
max_connections: 1000
max_subscriptions: 1000
max_payload: 1MB

# Performance tuning
write_deadline: "2s"
ping_interval: "2m"
ping_max: 2
